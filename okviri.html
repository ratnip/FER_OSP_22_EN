<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Data frames and factors | Let’s program in R</title>
  <meta name="description" content="R Coursebook" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Data frames and factors | Let’s program in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="R Coursebook" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Data frames and factors | Let’s program in R" />
  
  <meta name="twitter:description" content="R Coursebook" />
  

<meta name="author" content="Damir Pintar" />


<meta name="date" content="2022-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vektori.html"/>
<link rel="next" href="control.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<style type="text/css">
.showopt {
  background-color: #004c93;
  color: #FFFFFF; 
  width: 140px;
  height: 4	0px;
  text-align: center;
  vertical-align: middle !important;
  float: right;
  font-family: sans-serif;
  font-size:10 pt;
  border-radius: 8px;
}

.showopt:hover {
    background-color: #dfe4f2;
    color: #004c93;
}

pre.plot {
  background-color: white !important;
}
</style>

<script>
 $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show solution</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show results</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show figure</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>(“Statistical Programming Fundamentals” course book)</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#foreword"><i class="fa fa-check"></i>Foreword</a></li>
</ul></li>
<li class="part"><span><b>I Basic elements of R</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#general-facts-about-r"><i class="fa fa-check"></i><b>1.1.1</b> General facts about R</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#r-alternatives"><i class="fa fa-check"></i><b>1.1.2</b> R alternatives</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#installing-software-support"><i class="fa fa-check"></i><b>1.2</b> Installing Software Support</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#overview-of-the-development-interface-rstudio"><i class="fa fa-check"></i><b>1.3</b> Overview of the development interface <em>RStudio</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#interactive-console"><i class="fa fa-check"></i><b>1.3.1</b> Interactive console</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#writing-r-scripts"><i class="fa fa-check"></i><b>1.3.2</b> Writing R scripts</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#r-markdown"><i class="fa fa-check"></i><b>1.3.3</b> <em>R Markdown</em></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#how-to-use-this-coursebook"><i class="fa fa-check"></i><b>1.4</b> How to use this coursebook?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tipovi.html"><a href="tipovi.html"><i class="fa fa-check"></i><b>2</b> Basic data types and operators</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tipovi.html"><a href="tipovi.html#basic-data-types"><i class="fa fa-check"></i><b>2.1</b> Basic data types</a></li>
<li class="chapter" data-level="2.2" data-path="tipovi.html"><a href="tipovi.html#operators"><i class="fa fa-check"></i><b>2.2</b> Operators</a></li>
<li class="chapter" data-level="2.3" data-path="tipovi.html"><a href="tipovi.html#missing-unknown-and-non-existent-values"><i class="fa fa-check"></i><b>2.3</b> Missing, unknown, and non-existent values</a></li>
<li class="chapter" data-level="" data-path="tipovi.html"><a href="tipovi.html#homework-exercises"><i class="fa fa-check"></i>Homework exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vektori.html"><a href="vektori.html"><i class="fa fa-check"></i><b>3</b> Vectors, matrices and lists</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vektori.html"><a href="vektori.html#vector"><i class="fa fa-check"></i><b>3.1</b> Vector</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="vektori.html"><a href="vektori.html#creating-a-vector"><i class="fa fa-check"></i><b>3.1.1</b> Creating a vector</a></li>
<li class="chapter" data-level="3.1.2" data-path="vektori.html"><a href="vektori.html#vector-concatenation"><i class="fa fa-check"></i><b>3.1.2</b> Vector concatenation</a></li>
<li class="chapter" data-level="3.1.3" data-path="vektori.html"><a href="vektori.html#operator"><i class="fa fa-check"></i><b>3.1.3</b> Operator <code>[</code></a></li>
<li class="chapter" data-level="3.1.4" data-path="vektori.html"><a href="vektori.html#principles-of-vectorization-and-recycling"><i class="fa fa-check"></i><b>3.1.4</b> Principles of vectorization and recycling</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vektori.html"><a href="vektori.html#index-vectors"><i class="fa fa-check"></i><b>3.2</b> Index vectors</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="vektori.html"><a href="vektori.html#positional-indexing"><i class="fa fa-check"></i><b>3.2.1</b> Positional Indexing</a></li>
<li class="chapter" data-level="3.2.2" data-path="vektori.html"><a href="vektori.html#conditional-indexing"><i class="fa fa-check"></i><b>3.2.2</b> Conditional indexing</a></li>
<li class="chapter" data-level="3.2.3" data-path="vektori.html"><a href="vektori.html#label-based-indexing"><i class="fa fa-check"></i><b>3.2.3</b> Label-based indexing</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vektori.html"><a href="vektori.html#matrices-and-arrays"><i class="fa fa-check"></i><b>3.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.4" data-path="vektori.html"><a href="vektori.html#matrix-slicing"><i class="fa fa-check"></i><b>3.4</b> Matrix slicing</a></li>
<li class="chapter" data-level="3.5" data-path="vektori.html"><a href="vektori.html#example-3.2---matrix-slicing"><i class="fa fa-check"></i><b>3.5</b> Example 3.2 - matrix slicing</a></li>
<li class="chapter" data-level="3.6" data-path="vektori.html"><a href="vektori.html#lists"><i class="fa fa-check"></i><b>3.6</b> Lists</a></li>
<li class="chapter" data-level="" data-path="vektori.html"><a href="vektori.html#homework-exercises-1"><i class="fa fa-check"></i>Homework exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="okviri.html"><a href="okviri.html"><i class="fa fa-check"></i><b>4</b> Data frames and factors</a>
<ul>
<li class="chapter" data-level="4.1" data-path="okviri.html"><a href="okviri.html#data-frames"><i class="fa fa-check"></i><b>4.1</b> Data frames</a></li>
<li class="chapter" data-level="4.2" data-path="okviri.html"><a href="okviri.html#selecting-rows-and-columns"><i class="fa fa-check"></i><b>4.2</b> Selecting rows and columns</a>
<ul>
<li class="chapter" data-level="10.1.2" data-path="dates.html"><a href="dates.html"><i class="fa fa-check"></i><b>10.1.2</b> The<code>POSIXct</code> and<code>POSIXlt</code> classes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dates.html"><a href="dates.html#the-lubridate-package"><i class="fa fa-check"></i><b>10.2</b> The <code>lubridate</code> package</a></li>
<li class="chapter" data-level="10.3" data-path="dates.html"><a href="dates.html#working-with-character-strings"><i class="fa fa-check"></i><b>10.3</b> Working with character strings</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dates.html"><a href="dates.html#text-analysis-and-regular-expressions"><i class="fa fa-check"></i><b>10.3.1</b> Text analysis and regular expressions</a></li>
<li class="chapter" data-level="10.3.2" data-path="dates.html"><a href="dates.html#the-stringr-package"><i class="fa fa-check"></i><b>10.3.2</b> The <code>stringr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dates.html"><a href="dates.html#exercise-tasks-1"><i class="fa fa-check"></i>Exercise Tasks</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Let’s program in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="okviri" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Data frames and factors<a href="okviri.html#okviri" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="data-frames" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Data frames<a href="okviri.html#data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data frame is by far the most popular element of the programming language R. After all, the language R’s primary purpose is data analysis, and the data frame is provides an programmatic representation of the data set we intend to analyze. In other words, the data frame is an object similar in function to a sheet in <em>Microsoft Excel</em> or a table in a relational database. Almost every session in R revolves around manipulating data frames in certain ways - but while in <em>Excel</em> we mostly interact with the table with the help of a graphical interface, and in relational database via the query language <em>SQL</em>, in R we manage data programmatically using data frames.</p>
<p>Let’s take for example the following table:</p>
<table>
<thead>
<tr class="header">
<th>zipCode</th>
<th>cityName</th>
<th>avgSalKn</th>
<th>population</th>
<th>cityTax</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10000</td>
<td>Zagreb</td>
<td>6359.00</td>
<td>790017</td>
<td>18</td>
</tr>
<tr class="even">
<td>51000</td>
<td>Rijeka</td>
<td>5418.00</td>
<td>128384</td>
<td>15</td>
</tr>
<tr class="odd">
<td>21000</td>
<td>Split</td>
<td>5170.00</td>
<td>167121</td>
<td>10</td>
</tr>
<tr class="even">
<td>31000</td>
<td>Osijek</td>
<td>4892.00</td>
<td>84104</td>
<td>13</td>
</tr>
<tr class="odd">
<td>20000</td>
<td>Dubrovnik</td>
<td>5348.00</td>
<td>28434</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>This data set that contains certain parameters related to cities in the Republic of Croatia (values inside are not necessarily accurate and are used for demonstration purposes; also, note that the value of <code>cityTax</code> is expressed as percentage amount). We can easily imagine how to write this data in <em>Excel</em> or create a relational table to store it. Now we will learn how to represent this data in programming language R.</p>
<hr />
<p>In the last lesson we learned that the <strong>list</strong> is a complex data type which serves as a kind of “universal container” with the help of which we can collect a number of different objects and put them within the same structure. The data frame makes just a tiny tweak of this notion - it’s also a “universal container”, but with a restriction that each element stored within needs to have the same number of its own elements, so the container itself can assume tabular structure when its contents are represented as columns. In other words, <strong>data frame is just a list with an additional restriction regarding the length of its elements</strong>.</p>
<p>The latter has a few very interesting consequences. First, since data frame inherits all features of a list, it allows us to leverage all functions and operators that work with lists. Additionally, the tabular nature of data frame’s contents allows us to treat it as a two-dimensional structure, effectively inheriting functions and operators that work on matrices. In other words, <strong>data frames at the same time behave as matrices as lists</strong>, allowing us to seamless apply knowledge about those data structures when manipulating this newly introduced type.</p>
<hr />
<p>But first, let’s learn how to create these objects. There are several ways to create data frames, and we’ll show two of the most frequently encountered scenarios in practice:</p>
<ul>
<li>Manual creation via the <code>data.frame</code> function</li>
<li>Loading data from an external source using a helper function</li>
</ul>
<p>Let’s see both of these cases. First, we will create a data frame programmatically.</p>
<hr />
<p><strong>Exercise 4.1 - creating data frames programatically</strong></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="okviri.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice the similarity with list creation!</span></span>
<span id="cb129-2"><a href="okviri.html#cb129-2" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">zipCode =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">51000</span>, <span class="dv">21000</span>, <span class="dv">31000</span>, <span class="dv">20000</span>),</span>
<span id="cb129-3"><a href="okviri.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cityName =</span> <span class="fu">c</span>(<span class="st">&quot;Zagreb&quot;</span>, <span class="st">&quot;Rijeka&quot;</span>, <span class="st">&quot;Split&quot;</span>, <span class="st">&quot;Osijek&quot;</span>, <span class="st">&quot;Dubrovnik&quot;</span>),</span>
<span id="cb129-4"><a href="okviri.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">avgSalKn =</span> <span class="fu">c</span>(<span class="fl">6359.</span>, <span class="fl">5418.</span>, <span class="fl">5170.</span>, <span class="fl">4892.</span>, <span class="fl">5348.</span>),</span>
<span id="cb129-5"><a href="okviri.html#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> <span class="fu">c</span>(<span class="dv">790017</span>, <span class="dv">128384</span>, <span class="dv">167121</span>, <span class="dv">84104</span>, <span class="dv">28434</span>),</span>
<span id="cb129-6"><a href="okviri.html#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cityTax =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">10</span>))</span>
<span id="cb129-7"><a href="okviri.html#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="okviri.html#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="okviri.html#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `cities`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="okviri.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice the similarity with list creation!</span></span>
<span id="cb130-2"><a href="okviri.html#cb130-2" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">zipCode =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">51000</span>, <span class="dv">21000</span>, <span class="dv">31000</span>, <span class="dv">2000</span>),</span>
<span id="cb130-3"><a href="okviri.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cityName =</span> <span class="fu">c</span>(<span class="st">&quot;Zagreb&quot;</span>, <span class="st">&quot;Rijeka&quot;</span>, <span class="st">&quot;Split&quot;</span>, <span class="st">&quot;Osijek&quot;</span>, <span class="st">&quot;Dubrovnik&quot;</span>),</span>
<span id="cb130-4"><a href="okviri.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">avgSalKn =</span> <span class="fu">c</span>(<span class="fl">6359.</span>, <span class="fl">5418.</span>, <span class="fl">5170.</span>, <span class="fl">4892.</span>, <span class="fl">5348.</span>),</span>
<span id="cb130-5"><a href="okviri.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> <span class="fu">c</span>(<span class="dv">790017</span>, <span class="dv">128384</span>, <span class="dv">167121</span>, <span class="dv">84104</span>, <span class="dv">28434</span>),</span>
<span id="cb130-6"><a href="okviri.html#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cityTax =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">10</span>))</span>
<span id="cb130-7"><a href="okviri.html#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="okviri.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `cities`</span></span>
<span id="cb130-9"><a href="okviri.html#cb130-9" aria-hidden="true" tabindex="-1"></a>cities</span></code></pre></div>
<pre><code>##   zipCode  cityName avgSalKn population cityTax
## 1   10000    Zagreb     6359     790017      18
## 2   51000    Rijeka     5418     128384      15
## 3   21000     Split     5170     167121      10
## 4   31000    Osijek     4892      84104      13
## 5    2000 Dubrovnik     5348      28434      10</code></pre>
</div>
<hr />
<p>If you like, try creating another data frame with differing lengths of subelements (“columns”). As you will see, this operation will result in an error and the data frame will not be created - R tries to keep the matrix nature of the frame always preserved.</p>
<p>A little note regarding terminology: the “data frame” is often referred to as simply a “frame” or a “table”. Likewise, for its elements we will interchangeably use terms such as “column”, “variable” or “attribute”. Finally, adhering to data frames tabular structure, we will refer to the horizontally aligned elements as “rows” or “observations”. These terms are in line with the standard way of referencing tabular elements and the common statistical terms referring to the datasets. If there is a chance of ambiguity depending on the context, the term that most unambiguously describes the referenced element will be used.</p>
<hr />
<p>Let’s try to load the table from an external source now. Although R allows different forms of external data, we will assume that the data is obtained in a standard “CSV format” (CSV - <em>comma-separated values</em>). This format is one of the most popular pure text data storage methods that has the advantage of being easy to create manually, as well as being recognized by most data management tools which can often readily import/export data in such format.</p>
<p>Below we can see an example of a CSV file that matches the data frame created in the previous example. Suppose the file is named <code>cities.csv</code>. Row values are separated by a comma (no spaces!). Every row (observation) is in its own your line, and the (optional!) first line represents the column names.</p>
<hr />
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="okviri.html#cb132-1" aria-hidden="true" tabindex="-1"></a>zipCode,cityName,avgSalKn,population,cityTax</span>
<span id="cb132-2"><a href="okviri.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="dv">10000</span>,Zagreb,<span class="fl">6359.00</span>,<span class="dv">790017</span>,<span class="dv">18</span> </span>
<span id="cb132-3"><a href="okviri.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="dv">51000</span>,Rijeka,<span class="fl">5418.00</span>,<span class="dv">128384</span>,<span class="dv">15</span></span>
<span id="cb132-4"><a href="okviri.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="dv">21000</span>,Split,<span class="fl">5170.00</span>,<span class="dv">167121</span>,<span class="dv">10</span></span>
<span id="cb132-5"><a href="okviri.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="dv">31000</span>,Osijek,<span class="fl">4892.00</span>,<span class="dv">84104</span>,<span class="dv">13</span> </span>
<span id="cb132-6"><a href="okviri.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="dv">20000</span>,Dubrovnik,<span class="fl">5348.00</span>,<span class="dv">28434</span>,<span class="dv">10</span></span></code></pre></div>
<hr />
<p>One of the potential problems with CSV files is that they use the comma as separator (<em>delimiter</em>) of column elements, and in certain languages, as a standard, a “decimal comma” is used instead of a decimal point. Because of this fact, there is an “alternative” CSV standard that uses a semi-colon as a separator which would make our CSV file in this case looks like this (let’s call it <code>citiesAlt.csv</code>):</p>
<hr />
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="okviri.html#cb133-1" aria-hidden="true" tabindex="-1"></a>zipCode;cityName;avgSalKn;population;cityTax</span>
<span id="cb133-2"><a href="okviri.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="dv">10000</span>;Zagreb;<span class="dv">6359</span>,<span class="dv">00</span>;<span class="dv">790017</span>;<span class="dv">18</span> </span>
<span id="cb133-3"><a href="okviri.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="dv">51000</span>;Rijeka;<span class="dv">5418</span>,<span class="dv">00</span>;<span class="dv">128384</span>;<span class="dv">15</span></span>
<span id="cb133-4"><a href="okviri.html#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="dv">21000</span>;Split;<span class="dv">5170</span>,<span class="dv">00</span>;<span class="dv">167121</span>;<span class="dv">10</span></span>
<span id="cb133-5"><a href="okviri.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="dv">31000</span>;Osijek;<span class="dv">4892</span>,<span class="dv">00</span>;<span class="dv">84104</span>;<span class="dv">13</span> </span>
<span id="cb133-6"><a href="okviri.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="dv">20000</span>;Dubrovnik;<span class="dv">5348</span>,<span class="dv">00</span>;<span class="dv">28434</span>;<span class="dv">10</span></span></code></pre></div>
<hr />
<p>Since the decimal point is a standard in the Republic of Croatia, in working with CSV files we have to be careful which of the two standards is being used, which cannot be discerned just from the extension alone. Luckily, the R language offers support functions for both standards, so once we identified which standard is being used in a particular file, we simply choose the appropriate function.</p>
<p>We will assume existence of the following two files in the same directory as the workbook:</p>
<ul>
<li><code>cities.csv</code></li>
<li><code>citiesAlt.csv</code></li>
</ul>
<p>(If you do not have these files available, you can easily create them with the help of plaintext editors (eg <em>Notepad</em> or <em>gedit</em>) by copy pasting the above rows.)</p>
<hr />
<p>To create data frames from CSV files we use the following functions:
- <code>read.csv</code> - for “normal” CSV files with a comma as a separator
- <code>read.csv2</code> - for the alternative CSV standard that uses semi-colons</p>
<p>The main input parameter of these functions is the path to the CSV file that we are loading. These functions also have a rich set of additional parameters that allow easy adoption to different scenarios. Also, both of these functions are derived from a more general function called <code>read.table</code> which in itself is even more flexible with respect to the number of different parameters and data load settings. It is recommended to check the documentation to see the entire spectrum of options which can be used for loading tabular data stored in plaintext files, and some of the more important ones will be listed below.</p>
<hr />
<p>As stated, a subset of the parameters (with the example of associated values) of <code>read.csv</code> (or <code>read.table</code>) functions that are useful to know are:</p>
<ul>
<li><code>header = FALSE</code> - for files without a header</li>
<li><code>sep = "#"</code> - for files that use some more “exotic” separator, in this case <code>#</code></li>
<li><code>na.strings = 'NULL'</code> - the term used in the dataset to represent the missing values that will ultimately become <code>NA</code> in R</li>
<li><code>nrows = 2000</code> - maximum number of lines to be read, in this case 2000</li>
<li><code>stringsAsFactors = F</code> - preventing automatic creation of factor columns (which we will learn in the lesson below)</li>
<li><code>encoding = 'UTF-8'</code> - for non-ASCII text encoding standards (especially if we are working with Croatian data which has diacritical characters)</li>
</ul>
<p>Let’s try to load data from available CSV files now. This data will not require special parameters, and will only be loaded by providing the path to the associated files (one that uses the comma and the other that uses the semi-colon as a separator).</p>
<hr />
<p><strong>Exercise 4.2 - reading CSV files</strong></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="okviri.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data from files `cities.csv` and `citiesAlt.csv`</span></span>
<span id="cb134-2"><a href="okviri.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and store it in variables called `cities2` and `cities3` </span></span>
<span id="cb134-3"><a href="okviri.html#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="okviri.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print `cities2` and` cities3` </span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="okviri.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data from files `cities.csv` and `citiesAlt.csv`</span></span>
<span id="cb135-2"><a href="okviri.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and store it in variables called `cities2` and `cities3` </span></span>
<span id="cb135-3"><a href="okviri.html#cb135-3" aria-hidden="true" tabindex="-1"></a>cities2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;cities.csv&quot;</span>)</span>
<span id="cb135-4"><a href="okviri.html#cb135-4" aria-hidden="true" tabindex="-1"></a>cities3 <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;citiesAlt.csv&quot;</span>)</span>
<span id="cb135-5"><a href="okviri.html#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="okviri.html#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print `cities2` and` cities3` </span></span>
<span id="cb135-7"><a href="okviri.html#cb135-7" aria-hidden="true" tabindex="-1"></a>cities2</span>
<span id="cb135-8"><a href="okviri.html#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb135-9"><a href="okviri.html#cb135-9" aria-hidden="true" tabindex="-1"></a>cities3 </span></code></pre></div>
<pre><code>##   zipCode  cityName avgSalKn population cityTax
## 1   10000    Zagreb     6359     790017      18
## 2   51000    Rijeka     5418     128384      15
## 3   21000     Split     5170     167121      10
## 4   31000    Osijek     4892      84104      13
## 5   20000 Dubrovnik     5348      28434      10
## -----------
##   zipCode  cityName avgSalKn population cityTax
## 1   10000    Zagreb     6359     790017      18
## 2   51000    Rijeka     5418     128384      15
## 3   21000     Split     5170     167121      10
## 4   31000    Osijek     4892      84104      13
## 5   20000 Dubrovnik     5348      28434      10</code></pre>
</div>
<hr />
<p>We have already mentioned that data frames behave both like lists and like matrices. Let’s look at some useful functions we used with these types of objects which may now become very useful when working with data frames:</p>
<ul>
<li><code>nrow</code> - number of rows</li>
<li><code>ncol</code> or <code>length</code> - the number of columns (“matrix” and “list” way!)</li>
<li><code>dim</code> - table dimensions</li>
<li><code>names</code> - column names</li>
<li><code>head</code> - prints several rows from the beginning of the table</li>
<li><code>tail</code> - prints several rows from the end of the table</li>
<li><code>str</code> - prints table structure</li>
<li><code>summary</code> - summarizes the statistical information about table columns</li>
</ul>
<p>Let’s try some of these functions:</p>
<hr />
<p><strong>Exercise 4.3 - working with data frames</strong></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="okviri.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the dimensions of the data frame `cities`</span></span>
<span id="cb137-2"><a href="okviri.html#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="okviri.html#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="okviri.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print the table structure of `cities`</span></span>
<span id="cb137-5"><a href="okviri.html#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="okviri.html#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="okviri.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print the first few rows of the data frame `cities`</span></span>
<span id="cb137-8"><a href="okviri.html#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="okviri.html#cb137-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-10"><a href="okviri.html#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print summarized statistical information about  `cities` </span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="okviri.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the dimensions of the data frame `cities`</span></span>
<span id="cb138-2"><a href="okviri.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cities)</span>
<span id="cb138-3"><a href="okviri.html#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="okviri.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb138-5"><a href="okviri.html#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="okviri.html#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print the table structure of `cities`</span></span>
<span id="cb138-7"><a href="okviri.html#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cities)</span>
<span id="cb138-8"><a href="okviri.html#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="okviri.html#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb138-10"><a href="okviri.html#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="okviri.html#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print the first few rows of the data frame `cities`</span></span>
<span id="cb138-12"><a href="okviri.html#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cities)</span>
<span id="cb138-13"><a href="okviri.html#cb138-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-14"><a href="okviri.html#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb138-15"><a href="okviri.html#cb138-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-16"><a href="okviri.html#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print summarized statistical information about  `cities` </span></span>
<span id="cb138-17"><a href="okviri.html#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cities)</span></code></pre></div>
<pre><code>## [1] 5 5
## -----------
## &#39;data.frame&#39;:    5 obs. of  5 variables:
##  $ zipCode   : num  10000 51000 21000 31000 2000
##  $ cityName  : chr  &quot;Zagreb&quot; &quot;Rijeka&quot; &quot;Split&quot; &quot;Osijek&quot; ...
##  $ avgSalKn  : num  6359 5418 5170 4892 5348
##  $ population: num  790017 128384 167121 84104 28434
##  $ cityTax   : num  18 15 10 13 10
## -----------
##   zipCode  cityName avgSalKn population cityTax
## 1   10000    Zagreb     6359     790017      18
## 2   51000    Rijeka     5418     128384      15
## 3   21000     Split     5170     167121      10
## 4   31000    Osijek     4892      84104      13
## 5    2000 Dubrovnik     5348      28434      10
## -----------
##     zipCode        cityName            avgSalKn      population    
##  Min.   : 2000   Length:5           Min.   :4892   Min.   : 28434  
##  1st Qu.:10000   Class :character   1st Qu.:5170   1st Qu.: 84104  
##  Median :21000   Mode  :character   Median :5348   Median :128384  
##  Mean   :23000                      Mean   :5437   Mean   :239612  
##  3rd Qu.:31000                      3rd Qu.:5418   3rd Qu.:167121  
##  Max.   :51000                      Max.   :6359   Max.   :790017  
##     cityTax    
##  Min.   :10.0  
##  1st Qu.:10.0  
##  Median :13.0  
##  Mean   :13.2  
##  3rd Qu.:15.0  
##  Max.   :18.0</code></pre>
</div>
<hr />
</div>
<div id="selecting-rows-and-columns" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Selecting rows and columns<a href="okviri.html#selecting-rows-and-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve already said multiple times that data frames behave both as matrices and as lists, and one place where we employ both of these facets simultaneously is when selecting rows and columns of data frames. Specifically, we often leverage the following:</p>
<ul>
<li>two-dimensional indexing - to identify rows and columns we want to keep</li>
<li>operator <code>$</code> - for referencing individual columns</li>
</ul>
<p>In practice, one of the most common indexing methods is combining conditional selection of rows (with filtering expressions which leverage the <code>$</code> operator), and the label-based indexing of columns (<em>SQL</em> experts will recognize this as a standard combination of <em>WHERE</em> and <em>SELECT</em>).</p>
<p>Let’s try to apply this in practice.</p>
<hr />
<p><strong>Exercise 4.4 - selecting rows and columns</strong></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="okviri.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the table `cities` (for reference)</span></span>
<span id="cb140-2"><a href="okviri.html#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="okviri.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print the first three rows, the third and fifth column</span></span>
<span id="cb140-4"><a href="okviri.html#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="okviri.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print just the column &quot;cityTax&quot;</span></span>
<span id="cb140-6"><a href="okviri.html#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="okviri.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print zipCodes and city names of all cities which </span></span>
<span id="cb140-8"><a href="okviri.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co"># have cityTax greater than 12% and a population of more than 100,000</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="okviri.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the table `cities` (for reference)</span></span>
<span id="cb141-2"><a href="okviri.html#cb141-2" aria-hidden="true" tabindex="-1"></a>cities</span>
<span id="cb141-3"><a href="okviri.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="okviri.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb141-5"><a href="okviri.html#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="okviri.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print the first three rows, the third and fifth column</span></span>
<span id="cb141-7"><a href="okviri.html#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="okviri.html#cb141-8" aria-hidden="true" tabindex="-1"></a>cities[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)]</span>
<span id="cb141-9"><a href="okviri.html#cb141-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-10"><a href="okviri.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb141-11"><a href="okviri.html#cb141-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-12"><a href="okviri.html#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print just the column &quot;cityTax&quot;</span></span>
<span id="cb141-13"><a href="okviri.html#cb141-13" aria-hidden="true" tabindex="-1"></a>cities<span class="sc">$</span>cityTax</span>
<span id="cb141-14"><a href="okviri.html#cb141-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-15"><a href="okviri.html#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb141-16"><a href="okviri.html#cb141-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-17"><a href="okviri.html#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print zipCodes and city names of all cities which </span></span>
<span id="cb141-18"><a href="okviri.html#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="co"># have cityTax greater than 12% and a population of more than 100,000</span></span>
<span id="cb141-19"><a href="okviri.html#cb141-19" aria-hidden="true" tabindex="-1"></a>cities[cities<span class="sc">$</span>cityTax <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">&amp;</span> cities<span class="sc">$</span>population <span class="sc">&gt;</span> <span class="dv">100000</span>, <span class="fu">c</span>(<span class="st">&quot;zipCode&quot;</span>, <span class="st">&quot;cityName&quot;</span>)]</span></code></pre></div>
<pre><code>##   zipCode  cityName avgSalKn population cityTax
## 1   10000    Zagreb     6359     790017      18
## 2   51000    Rijeka     5418     128384      15
## 3   21000     Split     5170     167121      10
## 4   31000    Osijek     4892      84104      13
## 5    2000 Dubrovnik     5348      28434      10
## -----------
##   cityName cityTax
## 1   Zagreb      18
## 2   Rijeka      15
## 3    Split      10
## -----------
## [1] 18 15 10 13 10
## -----------
##   zipCode cityName
## 1   10000   Zagreb
## 2   51000   Rijeka</code></pre>
<hr />
<p>Notice the similarity between the last expression and the SQL query:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="okviri.html#cb143-1" aria-hidden="true" tabindex="-1"></a>SELECT zipCode, cityName</span>
<span id="cb143-2"><a href="okviri.html#cb143-2" aria-hidden="true" tabindex="-1"></a>FROM cities</span>
<span id="cb143-3"><a href="okviri.html#cb143-3" aria-hidden="true" tabindex="-1"></a>WHERE cities.cityTax <span class="sc">&gt;</span> <span class="dv">12</span> AND cities.population <span class="sc">&gt;</span> <span class="dv">100000</span></span></code></pre></div>
<p>Choosing columns and rows is not difficult if we are well acquainted with index vector knowledge, but as it can be seen in the last example, the final expression is not necessarily easy to visually interpret (as compared to, for example, the SQL syntax that performs the same job). There are R packages which vastly reduce the complexity of writing and interpreting expressions such as these, which will be the subject of one of the future chapters.</p>
<hr />
<div id="adding-and-deleting-rows-and-columns" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Adding and deleting rows and columns<a href="okviri.html#adding-and-deleting-rows-and-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To add and delete rows and columns, we can again try to remember how we would perform a similar task when handling matrices and lists, and then apply this knowledge to data frames. When performing data analysis though, adding individual columns is a slightly more common practice than adding rows - it is uncommon to be manually adding new observations, but creating new columns out of existing ones is a relatively standard data preparation task.</p>
<p>The easiest way to add columns to the data frame is to mimic the way we add list elements - we just have to take care that the added column has the same number of elements as the other columns. New columns are often derived from existing columns via logical or arithmetic expressions.</p>
<hr />
<p><strong>Exercise 4.5 - adding new columns to a data frame</strong></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="okviri.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add the logical column` highCityTax` to the `cities` table</span></span>
<span id="cb144-2"><a href="okviri.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co"># which will indicate whether the cityTax is greater than 12%</span></span>
<span id="cb144-3"><a href="okviri.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="okviri.html#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="okviri.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co"># assume the following (fabricated) way of estimating the income city gets from tax</span></span>
<span id="cb144-6"><a href="okviri.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - assume all cities have about 60% of working population</span></span>
<span id="cb144-7"><a href="okviri.html#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - assume each worker pays a tax that is roughly equal to 10% of their net salary</span></span>
<span id="cb144-8"><a href="okviri.html#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - assume income from city tax per worker is (cityTax percentage)*(tax income)</span></span>
<span id="cb144-9"><a href="okviri.html#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb144-10"><a href="okviri.html#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add a `monthlyTaxIncome` column which will use the average salary, city tax </span></span>
<span id="cb144-11"><a href="okviri.html#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co"># rate and population to estimate the monthly tax income of the cities</span></span>
<span id="cb144-12"><a href="okviri.html#cb144-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (in million Kns)</span></span>
<span id="cb144-13"><a href="okviri.html#cb144-13" aria-hidden="true" tabindex="-1"></a><span class="co"># round the result to two decimals using the `round` function,</span></span>
<span id="cb144-14"><a href="okviri.html#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  (example: round(100.12345, 2) ==&gt;  100.12  )</span></span>
<span id="cb144-15"><a href="okviri.html#cb144-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-16"><a href="okviri.html#cb144-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-17"><a href="okviri.html#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print `cities`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="okviri.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add the logical column` highCityTax` to the `cities` table</span></span>
<span id="cb145-2"><a href="okviri.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># which will indicate whether the cityTax is greater than 12%</span></span>
<span id="cb145-3"><a href="okviri.html#cb145-3" aria-hidden="true" tabindex="-1"></a>cities<span class="sc">$</span>highCityTax <span class="ot">&lt;-</span> cities<span class="sc">$</span>cityTax <span class="sc">&gt;</span> <span class="dv">12</span></span>
<span id="cb145-4"><a href="okviri.html#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="okviri.html#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="okviri.html#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># assume the following (fabricated) way of estimating the income city gets from tax</span></span>
<span id="cb145-7"><a href="okviri.html#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - assume all cities have about 60% of working population</span></span>
<span id="cb145-8"><a href="okviri.html#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - assume each worker pays a tax that is roughly equal to 10% of their net salary</span></span>
<span id="cb145-9"><a href="okviri.html#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - assume income from city tax per worker is (cityTax percentage)*(tax income)</span></span>
<span id="cb145-10"><a href="okviri.html#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb145-11"><a href="okviri.html#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add a `monthlyTaxIncome` column which will use the average salary, city tax </span></span>
<span id="cb145-12"><a href="okviri.html#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co"># rate and population to estimate the monthly tax income of the cities</span></span>
<span id="cb145-13"><a href="okviri.html#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (in million Kns)</span></span>
<span id="cb145-14"><a href="okviri.html#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="co"># round the result to two decimals using the `round` function,</span></span>
<span id="cb145-15"><a href="okviri.html#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  (example: round(100.12345, 2) ==&gt;  100.12  )</span></span>
<span id="cb145-16"><a href="okviri.html#cb145-16" aria-hidden="true" tabindex="-1"></a>cities<span class="sc">$</span>monthlyTaxIncome<span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.6</span> <span class="sc">*</span> cities<span class="sc">$</span>population <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> </span>
<span id="cb145-17"><a href="okviri.html#cb145-17" aria-hidden="true" tabindex="-1"></a>                          cities<span class="sc">$</span>avgSalKn  <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">*</span> cities<span class="sc">$</span>cityTax <span class="sc">/</span> <span class="fl">1e6</span> , <span class="dv">2</span>)</span>
<span id="cb145-18"><a href="okviri.html#cb145-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-19"><a href="okviri.html#cb145-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-20"><a href="okviri.html#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="co"># print `cities`</span></span>
<span id="cb145-21"><a href="okviri.html#cb145-21" aria-hidden="true" tabindex="-1"></a>cities</span></code></pre></div>
<pre><code>##   zipCode  cityName avgSalKn population cityTax highCityTax monthlyTaxIncome
## 1   10000    Zagreb     6359     790017      18        TRUE             5.43
## 2   51000    Rijeka     5418     128384      15        TRUE             0.63
## 3   21000     Split     5170     167121      10       FALSE             0.52
## 4   31000    Osijek     4892      84104      13        TRUE             0.32
## 5    2000 Dubrovnik     5348      28434      10       FALSE             0.09</code></pre>
</div>
<hr />
<p>You can also add rows and columns similar to adding rows and columns to a matrix - with the <code>rbind</code> and<code>cbind</code> functions. We can use <code>rbind</code> to add new observations to the data frame (respecting the order of columns in the original data frame). With <code>cbind</code> we can add a completely new vector as a column, keeping in mind that the number of elements corresponds to the number of rows of the original data frame.</p>
<p>Let’s try these functions on small “artificial” data frames to better demonstrate their functionality.</p>
<hr />
<p><strong>Exercise 4.6 - data frames and <code>rbind</code>/<code>cbind</code> functions</strong></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="okviri.html#cb147-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">b =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">c =</span> <span class="fu">c</span>(T, F, T))</span>
<span id="cb147-2"><a href="okviri.html#cb147-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="st">&quot;A&quot;</span>, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb147-3"><a href="okviri.html#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="okviri.html#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a data frame which has `df1` and `df2` as rows</span></span>
<span id="cb147-5"><a href="okviri.html#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co"># name it `df12`</span></span>
<span id="cb147-6"><a href="okviri.html#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="okviri.html#cb147-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-8"><a href="okviri.html#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add a `firstNames` columns containing names Ivo, Ana, Pero and Stipe</span></span>
<span id="cb147-9"><a href="okviri.html#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use `cbind`</span></span>
<span id="cb147-10"><a href="okviri.html#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="okviri.html#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print `df12`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="okviri.html#cb148-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">b =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">c =</span> <span class="fu">c</span>(T, F, T))</span>
<span id="cb148-2"><a href="okviri.html#cb148-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="st">&quot;A&quot;</span>, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb148-3"><a href="okviri.html#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="okviri.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a data frame which has `df1` and `df2` as rows</span></span>
<span id="cb148-5"><a href="okviri.html#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co"># name it `df12`</span></span>
<span id="cb148-6"><a href="okviri.html#cb148-6" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1, df2)</span>
<span id="cb148-7"><a href="okviri.html#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="okviri.html#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add a `firstNames` columns containing names Ivo, Ana, Pero and Stipe</span></span>
<span id="cb148-9"><a href="okviri.html#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use `cbind`</span></span>
<span id="cb148-10"><a href="okviri.html#cb148-10" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df12, <span class="at">firstNames =</span> <span class="fu">c</span>(<span class="st">&quot;Ivo&quot;</span>, <span class="st">&quot;Ana&quot;</span>, <span class="st">&quot;Pero&quot;</span>, <span class="st">&quot;Stipe&quot;</span>))</span>
<span id="cb148-11"><a href="okviri.html#cb148-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-12"><a href="okviri.html#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print `df12`</span></span>
<span id="cb148-13"><a href="okviri.html#cb148-13" aria-hidden="true" tabindex="-1"></a>df12</span></code></pre></div>
<pre><code>##   a b c firstNames
## 1 1 A 1        Ivo
## 2 2 B 0        Ana
## 3 3 C 1       Pero
## 4 1 A 3      Stipe</code></pre>
</div>
<hr />
<p>For <em>deleting rows and columns</em> we can also use the same methods for managing matrices and lists. Specifically:</p>
<ul>
<li>to delete rows and columns we simply use two-dimensional indexing and store the result in the original datga frame</li>
<li>to delete columns can we assign the value <code>NULL</code> to the selected column</li>
</ul>
<p>Let’s try this in the example.</p>
<hr />
<p><strong>Exercise 4.7 - deleting rows and columns</strong></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="okviri.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># delete the first row and second column from `df12`</span></span>
<span id="cb150-2"><a href="okviri.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use the indexing method</span></span>
<span id="cb150-3"><a href="okviri.html#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="okviri.html#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="okviri.html#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># delete the `firstNames` column by using the `NULL` method</span></span>
<span id="cb150-6"><a href="okviri.html#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="okviri.html#cb150-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-8"><a href="okviri.html#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print `df12`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="okviri.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># delete the first row and second column from `df12`</span></span>
<span id="cb151-2"><a href="okviri.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use the indexing method</span></span>
<span id="cb151-3"><a href="okviri.html#cb151-3" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> df12[<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">4</span>]    </span>
<span id="cb151-4"><a href="okviri.html#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="okviri.html#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># delete the `firstNames` column by using the `NULL` method</span></span>
<span id="cb151-6"><a href="okviri.html#cb151-6" aria-hidden="true" tabindex="-1"></a>df12<span class="sc">$</span>firstNames <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb151-7"><a href="okviri.html#cb151-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-8"><a href="okviri.html#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print `df12`</span></span>
<span id="cb151-9"><a href="okviri.html#cb151-9" aria-hidden="true" tabindex="-1"></a>df12</span></code></pre></div>
<pre><code>##   a b c
## 2 2 B 0
## 3 3 C 1
## 4 1 A 3</code></pre>
</div>
<hr />
<p>We will get back to data frame management in one of the future chapters, where we will introduce new packages that completely reinvent most of base R functionality for this purpose. For now, we will end the introduction of R data types with one of the extremely popular derived data types - a factor.</p>
<hr />
</div>
<div id="factors" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Factors<a href="okviri.html#factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Factors</strong> in R are a data type that represents what is referred to in statistics as a <strong>nominal</strong> or <strong>categorical</strong> variable. Namely, the attribute of some observation often takes on a value from a set of previously known categories (e.g. gender, age category, education, city of birth, political party preference, etc.). Categories are often identified by a unique set of characters, and are often leveraged for various aggregations and groupings (for example, in a sports race we can calculate the average time depending on gender or age category) or filtering (we analyze only data pertaining to certain categories).</p>
<p>Factors in R are very useful since they inherently carry metadata about their nature, allowing various function to readily recognize factors as such and deal with them accordingly (for example, visualization functions will use a discrete set of colors and a legend to denote categorical values). However, factors can also be a source of contention for R beginners because if used incorrectly they can lead to some inconvenient side-effects. This can all be easily avoided by learning specifics how they work and sticking to certain guidelines we will outline during this chapter.</p>
<hr />
<p>Let’s first demonstrate what factors actually are with the help of a simple example. Let’s imagine that we are doing a study which has ten medical patients (referred to by their ordinal number in study), and that the next character vector describes the blood pressure level in these patients:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="okviri.html#cb153-1" aria-hidden="true" tabindex="-1"></a>bloodPressure <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb153-2"><a href="okviri.html#cb153-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p>This is obviously a “categorical” variable since it can take one of three discrete values - <code>low</code>, <code>normal</code> and <code>high</code>. Thus, this vector is a typical candidate for “factorizing”, i.e. for converting from a character vector into a <code>factor</code> class object. We can easily create these objects by using the <code>factor</code> function to which we can simply the character vector of category names.</p>
<hr />
<p><strong>Exercise 4.8 - factorizing a character vector</strong></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="okviri.html#cb154-1" aria-hidden="true" tabindex="-1"></a>bloodPressure <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb154-2"><a href="okviri.html#cb154-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb154-3"><a href="okviri.html#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="okviri.html#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure`</span></span>
<span id="cb154-5"><a href="okviri.html#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="okviri.html#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print its class</span></span>
<span id="cb154-7"><a href="okviri.html#cb154-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-8"><a href="okviri.html#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable `bloodPressure.f` by factorizing</span></span>
<span id="cb154-9"><a href="okviri.html#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the variable `bloodPressure`</span></span>
<span id="cb154-10"><a href="okviri.html#cb154-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-11"><a href="okviri.html#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f`</span></span>
<span id="cb154-12"><a href="okviri.html#cb154-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-13"><a href="okviri.html#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print its class</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="okviri.html#cb155-1" aria-hidden="true" tabindex="-1"></a>bloodPressure <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;normal&quot;</span>,</span>
<span id="cb155-2"><a href="okviri.html#cb155-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb155-3"><a href="okviri.html#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="okviri.html#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="okviri.html#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure`</span></span>
<span id="cb155-6"><a href="okviri.html#cb155-6" aria-hidden="true" tabindex="-1"></a>bloodPressure</span>
<span id="cb155-7"><a href="okviri.html#cb155-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-8"><a href="okviri.html#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print its class</span></span>
<span id="cb155-9"><a href="okviri.html#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bloodPressure)</span>
<span id="cb155-10"><a href="okviri.html#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="okviri.html#cb155-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-12"><a href="okviri.html#cb155-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-13"><a href="okviri.html#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable `bloodPressure.f` by factorizing</span></span>
<span id="cb155-14"><a href="okviri.html#cb155-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the variable `bloodPressure`</span></span>
<span id="cb155-15"><a href="okviri.html#cb155-15" aria-hidden="true" tabindex="-1"></a>bloodPressure.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(bloodPressure)</span>
<span id="cb155-16"><a href="okviri.html#cb155-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-17"><a href="okviri.html#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb155-18"><a href="okviri.html#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="okviri.html#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f`</span></span>
<span id="cb155-20"><a href="okviri.html#cb155-20" aria-hidden="true" tabindex="-1"></a>bloodPressure.f</span>
<span id="cb155-21"><a href="okviri.html#cb155-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-22"><a href="okviri.html#cb155-22" aria-hidden="true" tabindex="-1"></a><span class="co"># print its class</span></span>
<span id="cb155-23"><a href="okviri.html#cb155-23" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bloodPressure.f)</span></code></pre></div>
<pre><code>##  [1] &quot;low&quot;    &quot;high&quot;   &quot;high&quot;   &quot;normal&quot; &quot;normal&quot; &quot;low&quot;    &quot;high&quot;   &quot;low&quot;   
##  [9] &quot;normal&quot; &quot;normal&quot;
## [1] &quot;character&quot;
## -----------
##  [1] low    high   high   normal normal low    high   low    normal normal
## Levels: high low normal
## [1] &quot;factor&quot;</code></pre>
</div>
<hr />
<p>Notice the subtle difference between printing a character vector and a factor. The printout of the factor is given an additional attribute called <code>Levels</code>. Also, the category names are now lacking quotation marks, further reinforcing the notion that these are not really character values as such.</p>
<p>What have we gained by turning a character vector into a factor? For starters, it will make it harder to add an observation with an invalid category to it. For example, if we try to add a new value to a factor that is not present in the current categories (e.g., “very high”) we will get a warning, and instead of the category we have specified, a new item will have the value of <code>NA</code>.</p>
<p>This is usually a desirable behaviour, since we don’t like having “dirty” data with incorrect category values. However, sometimes we may be caught unaware if a perfectly valid category gets stored as <code>NA</code>. This may happen if in the process of categorizing a character vector this original vector did not contain all the possible categories that may generally appear.</p>
<p>To alleviate this issue, we have the option of adding the <code>levels</code> parameter in which we will explicitly specify a series of all possible categories with a help of a separate character vector.</p>
<hr />
<p><strong>Exercise 4.9 - using the <code>levels</code> attribute</strong></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="okviri.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add an 11th element to `bloodPressure.f` called &quot;very low&quot; </span></span>
<span id="cb157-2"><a href="okviri.html#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="okviri.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f`</span></span>
<span id="cb157-4"><a href="okviri.html#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="okviri.html#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable `bloodPressure.f2` by factorizing</span></span>
<span id="cb157-6"><a href="okviri.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the variable `bloodPressure`</span></span>
<span id="cb157-7"><a href="okviri.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add the `levels` attribute which will also contain</span></span>
<span id="cb157-8"><a href="okviri.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co"># values &quot;very low&quot; and &quot;very high&quot;</span></span>
<span id="cb157-9"><a href="okviri.html#cb157-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-10"><a href="okviri.html#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add an 11th element to `bloodPressure.f2` called &quot;very low&quot; </span></span>
<span id="cb157-11"><a href="okviri.html#cb157-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-12"><a href="okviri.html#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f2`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="okviri.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add an 11th element to `bloodPressure.f` called &quot;very low&quot; </span></span>
<span id="cb158-2"><a href="okviri.html#cb158-2" aria-hidden="true" tabindex="-1"></a>bloodPressure.f[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="st">&quot;very low&quot;</span></span></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, 11, value = &quot;very low&quot;): invalid factor level,
## NA generated</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="okviri.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f`</span></span>
<span id="cb160-2"><a href="okviri.html#cb160-2" aria-hidden="true" tabindex="-1"></a>bloodPressure.f</span>
<span id="cb160-3"><a href="okviri.html#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="okviri.html#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="okviri.html#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb160-6"><a href="okviri.html#cb160-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-7"><a href="okviri.html#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable `bloodPressure.f2` by factorizing</span></span>
<span id="cb160-8"><a href="okviri.html#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the variable `bloodPressure`</span></span>
<span id="cb160-9"><a href="okviri.html#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add the `levels` attribute which will also contain</span></span>
<span id="cb160-10"><a href="okviri.html#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co"># values &quot;very low&quot; and &quot;very high&quot;</span></span>
<span id="cb160-11"><a href="okviri.html#cb160-11" aria-hidden="true" tabindex="-1"></a>bloodPressure.f2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(bloodPressure,</span>
<span id="cb160-12"><a href="okviri.html#cb160-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;very low&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;very high&quot;</span>))</span>
<span id="cb160-13"><a href="okviri.html#cb160-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-14"><a href="okviri.html#cb160-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add an 11th element to `bloodPressure.f2` called &quot;very low&quot; </span></span>
<span id="cb160-15"><a href="okviri.html#cb160-15" aria-hidden="true" tabindex="-1"></a>bloodPressure.f2[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="st">&quot;very low&quot;</span></span>
<span id="cb160-16"><a href="okviri.html#cb160-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-17"><a href="okviri.html#cb160-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f2`</span></span>
<span id="cb160-18"><a href="okviri.html#cb160-18" aria-hidden="true" tabindex="-1"></a>bloodPressure.f2</span></code></pre></div>
<pre><code>##  [1] low    high   high   normal normal low    high   low    normal normal
## [11] &lt;NA&gt;  
## Levels: high low normal
## -----------
##  [1] low      high     high     normal   normal   low      high     low     
##  [9] normal   normal   very low
## Levels: very low low normal high very high</code></pre>
</div>
<hr />
<p>Since factors are generally very useful, it is recommended that we always take care to properly “factorize” categorical columns in our data frames.</p>
<p>Let’s show one simple function which is often used in conjunction with factors. Analysts are often very interested in distribution of categories in a data set. To get this information, we can use the function called <code>table</code> who will get a factor in question as an input parameter.
***</p>
<p><strong>Exercise 4.10 - the <code>table</code> function</strong></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="okviri.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the distribution of categories in `bloodPressure.f2`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="okviri.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the distribution of categories in `bloodPressure.f2`</span></span>
<span id="cb163-2"><a href="okviri.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bloodPressure.f2)</span></code></pre></div>
<pre><code>## bloodPressure.f2
##  very low       low    normal      high very high 
##         1         3         4         3         0</code></pre>
</div>
<p>The <code>table</code> function does not necessarily require a factor and will work even with the character vector. However in that case we would not get information about categories that were not represented at all (which is often very important).</p>
<hr />
<p>The categorical variable in our examples actually has the so-called ordinal nature. In <strong>ordinal category variables</strong> the categories have a natural order (“low” blood pressure is lower than “normal” which in turn is lower than “high”). If desired, this fact can be “embedded” in the initialization process by simply adding the <code>order</code> parameter set to <code>TRUE</code>. The advantage of the ordinal factor is that it allows us to compare factor values with the help of comparative operators.</p>
<hr />
<p><strong>Exercise 4.11 - ordinal factor</strong></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="okviri.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable `bloodPressure.f3` by factorizing</span></span>
<span id="cb165-2"><a href="okviri.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the variable `bloodPressure`</span></span>
<span id="cb165-3"><a href="okviri.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add the `levels` attribute which will also contain</span></span>
<span id="cb165-4"><a href="okviri.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># values &quot;very low&quot; and &quot;very high&quot;</span></span>
<span id="cb165-5"><a href="okviri.html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co"># also set the `order` paramater to `TRUE`</span></span>
<span id="cb165-6"><a href="okviri.html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co"># watch out for category ordering!</span></span>
<span id="cb165-7"><a href="okviri.html#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="okviri.html#cb165-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-9"><a href="okviri.html#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f3`</span></span>
<span id="cb165-10"><a href="okviri.html#cb165-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-11"><a href="okviri.html#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="okviri.html#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="co"># check if it is in fact the ordinal factor now</span></span>
<span id="cb165-13"><a href="okviri.html#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="co"># using the `is.ordered` function</span></span>
<span id="cb165-14"><a href="okviri.html#cb165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-15"><a href="okviri.html#cb165-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-16"><a href="okviri.html#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the first patient has lower blood pressure</span></span>
<span id="cb165-17"><a href="okviri.html#cb165-17" aria-hidden="true" tabindex="-1"></a><span class="co"># than the third</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="okviri.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a variable `bloodPressure.f3` by factorizing</span></span>
<span id="cb166-2"><a href="okviri.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the variable `bloodPressure`</span></span>
<span id="cb166-3"><a href="okviri.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add the `levels` attribute which will also contain</span></span>
<span id="cb166-4"><a href="okviri.html#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># values &quot;very low&quot; and &quot;very high&quot;</span></span>
<span id="cb166-5"><a href="okviri.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># also set the `order` paramater to `TRUE`</span></span>
<span id="cb166-6"><a href="okviri.html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co"># watch out for category ordering!</span></span>
<span id="cb166-7"><a href="okviri.html#cb166-7" aria-hidden="true" tabindex="-1"></a>bloodPressure.f3 <span class="ot">&lt;-</span> <span class="fu">factor</span>(bloodPressure,</span>
<span id="cb166-8"><a href="okviri.html#cb166-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;very low&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;very high&quot;</span>),</span>
<span id="cb166-9"><a href="okviri.html#cb166-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">order =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-10"><a href="okviri.html#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="okviri.html#cb166-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-12"><a href="okviri.html#cb166-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print the variable `bloodPressure.f3`</span></span>
<span id="cb166-13"><a href="okviri.html#cb166-13" aria-hidden="true" tabindex="-1"></a>bloodPressure.f3</span>
<span id="cb166-14"><a href="okviri.html#cb166-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-15"><a href="okviri.html#cb166-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-16"><a href="okviri.html#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="co"># check if it is in fact the ordinal factor now</span></span>
<span id="cb166-17"><a href="okviri.html#cb166-17" aria-hidden="true" tabindex="-1"></a><span class="co"># using the `is.ordered` function</span></span>
<span id="cb166-18"><a href="okviri.html#cb166-18" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ordered</span>(bloodPressure.f3)</span>
<span id="cb166-19"><a href="okviri.html#cb166-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-20"><a href="okviri.html#cb166-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-21"><a href="okviri.html#cb166-21" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the first patient has lower blood pressure</span></span>
<span id="cb166-22"><a href="okviri.html#cb166-22" aria-hidden="true" tabindex="-1"></a><span class="co"># than the third</span></span>
<span id="cb166-23"><a href="okviri.html#cb166-23" aria-hidden="true" tabindex="-1"></a>bloodPressure.f3[<span class="dv">1</span>] <span class="sc">&lt;</span> bloodPressure.f3[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>##  [1] low    high   high   normal normal low    high   low    normal normal
## Levels: very low &lt; low &lt; normal &lt; high &lt; very high
## [1] TRUE
## [1] TRUE</code></pre>
</div>
<hr />
<p>We have already stated that R like using the principle which goes “everything is a vector” - numbers are one-dimensional numeric vectors, matrices are vectors with added dimension parameter, lists are vectors of smaller lists, data frames are lists with added restrictions. In that vein, we can assume that factors are vectors, too. But what do they look like “under the hood”?</p>
<p>The implementation of a factor is actually relatively straightforward - it’s simply a numeric vector where each number corresponds to a certain category, meaning that each factor vector also contains an associated “code table” in the form of an accompanying character vector. In other words, the process of factorization entails&gt;</p>
<ul>
<li>placing all categories in a separate character vector (categories are either inferred from the original vector or explicitly set with the <code>levels</code> parameter)</li>
<li>assigning numeric values in the order of each category (eg: “low” -&gt; <code>1</code>, “normal” -&gt; <code>2</code> etc.)</li>
<li>“packing” together a newly created numeric vector and the associated “code table”</li>
</ul>
<p>Although these steps R works out automatically, the internal structure of a factor can easily be discovered through converting it into a pure numeric or pure character type.</p>
<hr />
<p><strong>Exercise 4.12 - internal structure of a factor</strong></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="okviri.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print `bloodPressure.f3` converted to a character</span></span>
<span id="cb168-2"><a href="okviri.html#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="okviri.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print `bloodPressure.f3` converted to a numeric</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="okviri.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print `bloodPressure.f3` converted to a character</span></span>
<span id="cb169-2"><a href="okviri.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(bloodPressure.f3)</span>
<span id="cb169-3"><a href="okviri.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="okviri.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print `bloodPressure.f3` converted to a numeric</span></span>
<span id="cb169-5"><a href="okviri.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(bloodPressure.f3)</span></code></pre></div>
<pre><code>##  [1] &quot;low&quot;    &quot;high&quot;   &quot;high&quot;   &quot;normal&quot; &quot;normal&quot; &quot;low&quot;    &quot;high&quot;   &quot;low&quot;   
##  [9] &quot;normal&quot; &quot;normal&quot;
##  [1] 2 4 4 3 3 2 4 2 3 3</code></pre>
</div>
<hr />
<p>By converting the factor to the character type we actually do the operation of inverse factorization, i.e., we may go back to the original character vector. On the other hand, by converting the factor into a numerical type, we will get a list of encoded numbers that the internal factor is used to represent each category.</p>
<p>One question can now arise - is there any benefit in converting a factor in its character or numeric counterpart?</p>
<p>The general answer is “no”. Factor variables will automatically behave as characters wherever necessary (for example if we want to filter out all the three-lettered names). And the numeric representation is meaningless without the information what each number actually corresponds to. However, knowing what happens when we convert a factor to a character or numeric vector can help us avoid a particularly nasty error which may occur if data analyst mishandles factor variables. Good news is that since R 4.0, the possibility of this error is severely diminished, but it’s still worthwhile to know the specifics what it entails, and how to avoid it.</p>
<p>The error in question happens when a numeric column is misidentified as a categorical column, which used to be a relatively common occurence when the analyst allowed R to automatically infer the types of columns being loaded from an external data source. Before version 4.0, R was pretty “factor happy”, meaning that it would first discern columns as either numerical (if <em>all</em> values could be converted into a number) or character (all other cases), which would then be followed by automatic factorization of character columns (unless this behaviour was explicitly turned off by setting the <code>stringsAsFactors = FALSE</code> parameter).</p>
<p>Now imagine we have tabular data where one entry has an error (for example, <code>7.07</code> was manually inserted as <code>7.O7</code>). Let’s simulate what might have happened in older versions of R.</p>
<div id="example-4.1---mishandling-factorization" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Example 4.1 - mishandling factorization<a href="okviri.html#example-4.1---mishandling-factorization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="okviri.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated &quot;typing error&quot;</span></span>
<span id="cb171-2"><a href="okviri.html#cb171-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">&quot;1.45&quot;</span>, <span class="st">&quot;5.77&quot;</span>, <span class="st">&quot;1.12&quot;</span>, <span class="st">&quot;7.O7&quot;</span>, <span class="st">&quot;3.23&quot;</span>),</span>
<span id="cb171-3"><a href="okviri.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>) <span class="co"># mimicking the behaviour pre-R 4.0</span></span>
<span id="cb171-4"><a href="okviri.html#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="okviri.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co"># trying to treat the &quot;numeric&quot; column as numeric reveals something weird</span></span>
<span id="cb171-6"><a href="okviri.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>measures)</span></code></pre></div>
<pre><code>## Warning in mean.default(df$measures): argument is not numeric or logical:
## returning NA</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="okviri.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the analyst realizes something is wrong and tries to convert the column to its proper type</span></span>
<span id="cb173-2"><a href="okviri.html#cb173-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>measures <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>measures)</span>
<span id="cb173-3"><a href="okviri.html#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="okviri.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># measure amounts are now irreversibly lost, an error which if not caught can cause serious</span></span>
<span id="cb173-5"><a href="okviri.html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># problems in subsequent steps of the analysis</span></span>
<span id="cb173-6"><a href="okviri.html#cb173-6" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## [1] NA
##   id measures
## 1  1        2
## 2  2        4
## 3  3        1
## 4  4        5
## 5  5        3</code></pre>
<hr />
<p>How to avoid this scenario? As stated, it has now become far less likely since from R 4.0 the default value of the <code>stringsAsFactors</code> was switched from <code>TRUE</code> to <code>FALSE</code>. Still, it pays off to take certain precautions, especially if there is a chance that our code will be run on platforms with earlier versions of R. Some of the useful guidelines are:</p>
<ul>
<li>When using the <code>read.csv</code> or<code>read.table</code> functions, always put the string <code>stringsAsFactors = FALSE</code></li>
<li>carefully check <strong>column type data</strong> of loaded data frame</li>
<li>perform appropriate column conversions</li>
<li>check the results again</li>
</ul>
<p>If we adhere to these steps we will almost never come to the situation which causes us real problems. There are additional methods, like explicitly telling column types when reading from a file (<code>colClasses</code> parameters), or using the <code>as.numeric(as.character(f))</code> syntax to be sure that a “numeric” factor will not be converted to a series of meaningless integers, but the above steps should in most cases be completely sufficient.</p>
<hr />
</div>
</div>
<div id="homework-exercises-2" class="section level2 unnumbered hasAnchor">
<h2>Homework exercises<a href="okviri.html#homework-exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Locate the file <code>citiesNOHEADER.csv</code> which represents the file that is the same as <code>cities.csv</code> except for the following features:</li>
</ol>
<ul>
<li>column names are missing</li>
<li>space is used as a separator</li>
</ul>
<p>Try using the documentation to load the data from this file into the variable called <code>citiesNH</code> which must end up identical to the variable <code>cities</code> used in this chapter.</p>
<ol start="2" style="list-style-type: decimal">
<li>Locate the file <code>receipt.csv</code> and load it into the <code>receipt</code> variable. Ensure that character sequences were not automatically converted into factors. Print to the screen:</li>
</ol>
<ul>
<li>the number of rows in this table</li>
<li>the number of columns in the table</li>
<li>column names</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>For the <code>receipt</code> table, do the following:</li>
</ol>
<ul>
<li>factorize the <code>itemCategory</code> column</li>
<li>print the code, name and price of all items of the <code>sweets and snacks</code> category cheaper than 12 Kn</li>
<li>print how many products each category has in the receipt</li>
<li>add a <code>total</code> column that will contain the total price of each purchased item, leveraging the price and quantity</li>
<li>calculate the total amount of the receipt</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Locate the file <code>citiesNULL.csv</code> which, if loaded without the<code>stringsAsFactors = FALSE</code> parameter, can result in a problematic scenario described in the lesson.</li>
</ol>
<p>Try to do the following:</p>
<ul>
<li>load the data from this file into the variable <code>citiesNULL</code> and deliberately set the parameter <code>stringsAsFactors = TRUE</code></li>
<li>add <code>avgSal1</code> column that will represent the result of using the <code>as.numeric</code> function over the <code>avgSalKn</code> column</li>
<li>add <code>avgSal2</code> column that will represent the result of using the combination of <code>as.character</code> and <code>as.numeric</code> functions over the <code>avgSalKn</code> column (be careful of the order)</li>
<li>print out <code>citiesNULL</code> and comment the results</li>
</ul>
<hr />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Programirajmo u R-u</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://www.fer.unizg.hr/en/damir.pintar" property="cc:attributionName" rel="cc:attributionURL">Damir Pintar</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://ratnip.github.io/FER_OPJR/" rel="dct:source">https://ratnip.github.io/FER_OPJR/</a></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="vektori.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="control.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"edit": null,
"download": null,
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
